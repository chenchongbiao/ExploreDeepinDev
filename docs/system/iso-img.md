**系统镜像类型：ISO vs IMG**

# **技术扫盲：ISO与IMG镜像的全面对比**

## **1. 核心定义与设计目标**

| **镜像类型** | **ISO**                                             | **IMG**                                    |
| ------------------ | --------------------------------------------------------- | ------------------------------------------------ |
| **全称**     | International Organization for Standardization (ISO 9660) | Raw Disk Image                                   |
| **设计初衷** | 标准化光盘存储格式，适配CD/DVD介质                        | 完整磁盘的逐扇区复制，适配块设备（如SD卡、硬盘） |
| **典型用途** | 操作系统安装盘、软件分发介质                              | 嵌入式设备系统镜像（如树莓派）、虚拟机磁盘文件   |

---

## **2. 技术特性对比**

| **对比维度**     | **ISO**                        | **IMG**                                           |
| ---------------------- | ------------------------------------ | ------------------------------------------------------- |
| **文件系统**     | 通常为单一ISO 9660或UDF分区          | 包含完整分区表（如MBR/GPT）和多分区结构                 |
| **引导兼容性**   | 依赖 `El Torito`扩展实现光盘引导   | 原生支持BIOS/UEFI引导                                   |
| **硬件适配**     | 通用性强，但无法直接写入U盘/SD卡运行 | 需针对设备定制分区布局（如树莓派 `/boot`必须为FAT32） |
| **可编辑性**     | 可挂载为只读，修改需重新打包         | 可直接挂载读写分区，实时修改文件                        |
| **树莓派兼容性** | ❌ 无法直接启动（需工具转换）        | ✅ 原生支持，`dd`写入即用                             |

---

## **3. 实际应用场景**

- **ISO镜像典型用例**：

  - **Windows安装盘**：通过Rufus工具将ISO写入U盘生成可引导安装介质
  - **Linux发行版安装**：Ubuntu ISO文件可直接挂载到虚拟机或刻录为DVD
  - **软件分发**：企业级软件（如VMware Tools）以ISO格式提供驱动包
- **IMG镜像典型用例**：

  - **树莓派系统部署**：Raspberry Pi OS的 `.img`文件直接写入SD卡即可运行
  - **虚拟机硬盘**：QEMU/KVM使用 `qcow2`或 `raw`格式IMG作为虚拟磁盘
  - **磁盘备份**：`dd if=/dev/sda of=disk.img` 生成完整的磁盘备份镜像

---

## **4. 转换与互操作**

- **ISO → IMG**（适用于树莓派）：

  ```bash
  # 转换并添加空白空间（树莓派需要额外分区）  
  dd if=source.iso of=output.img bs=4M  
  parted output.img --script -- mkpart primary ext4 700MiB 100%  
  ```
- **IMG → ISO**（仅限单分区系统）：

  ```bash
  # 提取ISO文件（需确认IMG内包含ISO9660文件系统）  
  mount -o loop input.img /mnt  
  mkisofs -o output.iso /mnt  
  ```

---

## **5. 为什么树莓派使用IMG而非ISO？**

1. **多分区需求**：树莓派需要独立的 `/boot`（FAT32）和 `/`（ext4）分区
2. **硬件兼容性**：IMG镜像完整保留分区表，确保GPU固件能正确读取引导文件
3. **写入工具简易性**：`dd`或 `balenaEtcher`等工具直接写入SD卡，无需处理光盘兼容性问题

---

## **6. 常见问题解答**

- **Q: 能否将树莓派IMG转换为ISO用于虚拟机？**✅ 可以，但需虚拟机配置为从虚拟磁盘启动，且可能丢失分区结构（建议直接使用IMG）。
- **Q: 如何编辑ISO镜像中的文件？**

  ```bash
  # 挂载ISO为只读  
  mount -o loop source.iso /mnt  
  # 复制内容到新目录，修改后重新生成ISO  
  mkisofs -o modified.iso /path/to/edited_files  
  ```
- **Q: IMG镜像文件太大，如何压缩？**

  ```bash
  # 转换为稀疏镜像（仅保留有效数据）  
  cp --sparse=always input.img compressed.img  
  # 或使用gzip压缩  
  gzip -k input.img  
  ```
